{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovates this repositories",
  "extends": [
    "config:recommended",
    "npm:unpublishSafe",
    ":combinePatchMinorReleases",
    ":semanticCommits",
    ":semanticCommitTypeAll(chore)",
    ":semanticCommitScopeDisabled"
  ],
  "onboarding": false,
  "ignorePaths": ["*/**/package.json"],
  "requireConfig": "ignored",
  "dependencyDashboard": true,
  "automerge": true,
  "autoApprove": true,
  "prHourlyLimit": 0,
  "prConcurrentLimit": 0,
  "enabledManagers": ["npm"],
  "printConfig": true,
  "labels": ["renovate"],
  "allowedPostUpgradeCommands": ["^(pnpm|echo)"],
  "postUpgradeTasks": {
    "description": "Renovate ignores nested package jsons. Use eslint to align dependencies in projects package.json when the root package.json changed.",
    "commands": [
      "echo 'Install node_modules when missing in order to run eslint'; dir='node_modules'; [ -d \"$dir\" ] && find \"$dir\" -mindepth 1 -maxdepth 1 -type d | wc -l || pnpm i --frozen-lockfile",
      "pnpm exec nx run-many -t lint-eslint --fix --rule '{\"@nx/dependency-checks\": \"error\"}'"
    ],
    "fileFilters": ["pnpm-lock.yaml"]
  },
  "lockFileMaintenance": {
    "enabled": true
  },
  "packageRules": [
    {
      "matchUpdateTypes": ["major"],
      "automerge": false
    },
    {
      "description": "'ignorePaths' seem to get overridding by the default config, so we disable them here",
      "matchFileNames": ["*/**/package.json"],
      "enabled": false
    },
    {
      "description": "ignore '@robby-rabbitman/nx-plus-*' packages, as nx release will handle it",
      "matchPackagePatterns": ["^@robby-rabbitman/nx-plus-"],
      "enabled": false
    },
    {
      "description": "Groups all '@commitlint' packages together",
      "groupName": "commitlint",
      "matchManagers": ["npm"],
      "matchPackagePatterns": ["^@commitlint/"]
    },
    {
      "description": "Groups all 'prettier' packages together",
      "groupName": "prettier",
      "matchManagers": ["npm"],
      "matchPackagePatterns": ["^prettier$", "^prettier-"]
    },
    {
      "description": "Groups all 'eslint' packages together",
      "groupName": "eslint",
      "matchManagers": ["npm"],
      "matchPackagePatterns": ["^eslint", "^@typescript-eslint/"]
    },
    {
      "description": "Groups all 'nx' packages together",
      "groupName": "nx",
      "matchManagers": ["npm"],
      "matchPackagePatterns": ["^@nx/", "^nx$"]
    }
  ]
}
